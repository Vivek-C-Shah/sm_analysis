flowchart TB
    subgraph PreProcess["Data Preprocessing & Storage"]
        A[Raw Social Media Data] --> B[Clean Data]
        B --> C[Transform Data]
        C --> D[Aggregate Data]
        D --> E[(Astra DB)]
    end

    subgraph Analysis["Data Querying & Analysis"]
        E --> F[Query Aggregated Data]
        F --> G[Calculate Metrics]
        G --> H[/Engagement Rate/]
        G --> I[/Like-to-Comment Ratio/]
        G --> J[/Share-to-Like Ratio/]
    end

    subgraph Langflow["Langflow Workflow"]
        K[User Input: post_type] --> L[Python Function Node]
        L --> M[Fetch Metrics]
        E -.-> M
        M --> N[Prompt Generation Node]
        H & I & J -.-> N
        N --> O[OpenAI Model Node]
        O --> P[Output Node: Insights]
    end

    subgraph Gradio["Gradio Interface"]
        Q[Dropdown: post_type] --> R[Display Panel]
        P -.-> R
        R --> S[Show Recommendations]
        R --> T[Show Insights]
    end

    K -.-> Q
